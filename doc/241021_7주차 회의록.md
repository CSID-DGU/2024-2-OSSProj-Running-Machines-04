## 📍 회의 안건

# 질의응답

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c92bed2f-d82e-4d2b-b5b1-9bc2a7d258e0/a62e5d00-b68f-46ea-9287-a4231d958818/image.png)

1. 유저 경로 이탈  시 대처법
    
    → 뛰다가 이탈시, 유저 코스로 변경
    
    → 유저 코스로 변경시, 경로 색상 변경 + 안내 문구(선택한 경로를 벗어났습니다!)
    
2. 코스 추천 후 신뢰성 검증 방법
    
    → 사용자 후기를 통해 신뢰성을 검증.
    
3. 실시간 업데이트 여부
    
    → 검증을 거쳐 매월 1일 업데이트
    
4. 코스 내의 장애물
    
    → 실시간 코스의 문제점은 데이터로 수집하기 어려움이 있음. 
    
    → 정책 등 경로 내, 큰 문제점이 있는 코스는 사전에 공지
    
    ※ `러닝 주의사항` 버튼으로 공지 (러닝 기록_지도 화면 내 구성) → 5km 반경 이내 주의사항이 있을 경우.
    
5. 추천경로 분석 시스템에 대한 구체적인 기능 구현 내용 - 호원 준비
6. LLM/AI 로직 및 정확도 - 호원 준비
7. 화면을 보며 뛰는 것이 불편할 것으로 우려됨
    
    → 갈림길에서 음성으로 안내 or 진동
    
    → 갈림길에서만 화면을 보고 코스에 따라 달리도록 함.
    
    → 기술적 한계가 있다면, 러닝 전 큰 화살표 등으로 지도 상에 표기
    

# 크루 가입 절차 확정

1안. 크루 가입 코드 단일로 확인

→ 채택!

2안. 크루 가입 코드 + 크루 리더 승인

# 데이터 정의

## 채팅 데이터

1. 사용자 이름
2. 프로필 사진
3. 채팅 내용
    1. 텍스트
    2. 이미지

## 공지글 데이터

1. 제목
2. 본문
3. 날짜
4. 작성자 - fix 크루 리더
5. 사진(선택)

 ※ 댓글 불가!!

## 갤러리 데이터

1. 제목
2. 본문
3. 날짜
4. 작성자
5. 사진 - 다중 가능
6. 댓글 가능

 ※  대댓글, 좋아요 불가!!

## 러닝 데이터

1. GPX 데이터(위경도,고도,시간)
2. 날짜
3. 태그
4. 소요 시간
5. 거리(GPX에서 따올 수 있음)
6. 평균페이스

※ GET - 코스명 추가

# 기타 기능 논의 사항

## 소속 크루 단일 가입?

- 여러 개 가입은 추후 업데이트 예정입니다.

## 타 크루 조회

- 소속 크루가 아닐 경우
    
    작성 불가
    
    멤버 조회 불가
    
    갤러리/공지 글 조회 가능
    

## 제외할 기능

- 날씨 기능
- 스크랩

## 러닝 추천 코스

- AI → 백엔드 → 프론트엔드 → 유저 화면
- 카카오맵 API
- 10m 간격으로 post 로컬 기록 → 러닝 종료시 백엔드 API post 요청
- 러닝 기록 데이터 ‘프론트엔드 → 백엔드 → AI

# 우선순위 결정

1. 회원가입
2. 전체 커뮤니티
3. 크루 커뮤니티
4. 홈
5. 러닝 기록
6. 마이페이지

※ 날씨 기능 제외

# 실시간 경로 API 통신 방안

- 10m 이동시 position/time을 로컬에 기록하고 러닝이 종료되면 백엔드에 전송

### 1. **프론트엔드 (플러터)에서의 경로 데이터 관리**

### 1-1. **위치 정보의 간격 최적화**

1시간 동안 매초마다 위치를 기록하면 많은 양의 데이터가 쌓이므로, **시간 간격을 최적화**하는 것이 중요합니다. 예를 들어, 매 5초 또는 사용자의 위치가 일정 범위를 벗어날 때만 기록하는 방식으로 데이터를 줄일 수 있습니다.

```dart
double distanceThreshold = 10.0; // 10미터 이상 이동 시 기록

void _trackPosition() async {
  Position position = await Geolocator.getCurrentPosition();
  if (route.isEmpty || _isSignificantMovement(position, route.last)) {
    route.add({
      'latitude': position.latitude,
      'longitude': position.longitude,
      'timestamp': DateTime.now().millisecondsSinceEpoch,
    });
  }
}

bool _isSignificantMovement(Position newPosition, Map<String, dynamic> lastPosition) {
  double distance = Geolocator.distanceBetween(
    lastPosition['latitude'], lastPosition['longitude'],
    newPosition.latitude, newPosition.longitude,
  );
  return distance > distanceThreshold;
}
```

### 1-2. **경로 데이터 간소화**

경로 데이터는 위도(latitude), 경도(longitude), 시간(timestamp) 등의 필수 정보만 저장하고, 고도(altitude) 등 나중에 필요할 때 추가할 수 있는 정보는 제외하여 메모리를 절약할 수 있습니다.

```json
[
  { "lat": 37.4219983, "lng": -122.084, "time": 1633072800000 },
  { "lat": 37.4221, "lng": -122.0841, "time": 1633072830000 }
]
```

### 1-3. **데이터 압축**

데이터를 수집할 때 매번 전송하지 않고, 일단 로컬에 저장해 두었다가 달리기가 끝난 후 한꺼번에 백엔드로 전송하는 방법이 효율적입니다. 이를 위해 플러터의 **로컬 저장소**를 활용할 수 있습니다. 예를 들어, `shared_preferences` 패키지를 사용해 일시적으로 데이터를 저장했다가, 달리기가 끝난 후 백엔드로 보냅니다.

### 2. **백엔드에서의 경로 데이터 관리**

### 2-1. **데이터베이스 저장 방식**

백엔드에서는 경로 데이터를 효율적으로 관리하기 위해 아래와 같은 방식을 고려할 수 있습니다.

- **개별 위치를 JSON 형태로 저장**: 각 경로 점을 `위도`, `경도`, `타임스탬프`로 구성된 JSON 객체 배열로 저장합니다. 이는 매우 직관적이지만 많은 점을 저장할 경우 데이터가 커질 수 있습니다.
- **경로 데이터를 압축한 다각형(Polyline) 형태로 저장**: 경로 데이터를 압축해 **Google Polyline Encoding**과 같은 방법을 사용해 좌표 데이터를 하나의 문자열로 압축해 저장할 수 있습니다. 이렇게 하면 메모리를 절약하면서도 경로를 손실 없이 표현할 수 있습니다.

### 2-2. **압축된 데이터 저장 예시**

- 경로 데이터를 단순한 배열로 저장하는 대신 압축된 폴리라인으로 저장할 수 있습니다. 이를 위해 구글 폴리라인 인코딩 방식을 사용할 수 있습니다.

```json
{
  "userId": "12345",
  "encodedRoute": "_p~iF~ps|U_ulLnnqC_mqNvxq`@"
}
```

이렇게 하면 경로 데이터의 크기가 크게 줄어들어 저장 효율이 높아집니다. 백엔드에서는 필요한 경우 압축을 풀어 데이터를 다시 활용할 수 있습니다.

### 2-3. **데이터베이스 설계**

- **경로 테이블**: 각 사용자가 저장한 경로의 시작점, 종료점, 거리, 경로 데이터 등을 저장하는 테이블을 구성합니다.
- **경로 정보 테이블 예시**:

| user_id | route_id | start_time | end_time | encoded_route | distance |
| --- | --- | --- | --- | --- | --- |
| 12345 | 67890 | 2024-10-21 07:00 | 2024-10-21 08:00 | "_p~~iF~~ps | U_ulLnnqC..." |

### 2-4. **경로 데이터 분석**

경로 데이터를 받으면, 백엔드에서는 추가로 거리를 계산하거나, 속도 등을 분석할 수 있습니다. 필요할 경우, 데이터베이스에 바로 쓸 수 있는 거리 및 속도 데이터를 저장하여 추후 분석에 사용합니다.

### 2-4-1. 경로 데이터

gpx 파일을 불러와서 시각화한 결과

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c92bed2f-d82e-4d2b-b5b1-9bc2a7d258e0/83a0a1e1-161d-41db-a759-d63b9c94033d/image.png)

# 중간발표에 포함할 내용

- 1차 중간 발표 내용에 추가하기 - 1차 내용은 간결하게.
- 피드백 수용 내용
- 진행상황 업데이트
- 스트라바에서 지원하는 GPX  각자 구를 나누어 다운로드 → 초기데이터로 활용

- 시연영상
    - 현위치 기준 추천 러닝 경로 띄우기
    - 나의 크루

- 데이터 분석(AI) 배포 여부에 따라, 더미데이터 혹은 실제 구현 결과물 보여줌

## 📍 결정 사항

# 협업 규칙

![스크린샷 2024-10-21 오후 4.23.49.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c92bed2f-d82e-4d2b-b5b1-9bc2a7d258e0/1b9f3d37-cd2f-4d40-a91b-e0e457aedb74/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-10-21_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.23.49.png)

## 브랜치

메인에서 분기해서 사용

```html
frontend/feature/signin
backend/fix

data/feature
```

## 커밋

```html
BE: [feature] 회원가입 #1
```

## 이슈

1. github에서 이슈생성
2. 커밋할 때 `#이슈번호` 
3. PR할 때 `이슈 닫기`

```
BE: [feature] 로그인 개발
```

## PR

- 템플릿대로 사용
- 이미지, gif, 영상 남겨주시면 감사하겠습니다.

```
BE: [feature] 로그인 개발 #1
```

## 📍 다음 회의 계획

- 일정
    
    10월 23일 (수)
    

- 내용
    - 스트라바에서 지원하는 GPX  각자 구를 나누어 다운로드 → 초기데이터로 활용

서영 - 종로구

주원 - 중구

희진 - 용산구

호원 - 마포구

현아 - 서초구

[스트라바 gpx 다운](https://www.notion.so/gpx-333983176e304701847be90e64b8a781?pvs=21)
